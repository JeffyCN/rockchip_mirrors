From 598a3a76d47d1a76a563e4cb9aa9e31d740e5a68 Mon Sep 17 00:00:00 2001
From: Jeffy Chen <jeffy.chen@rock-chips.com>
Date: Thu, 19 Oct 2023 15:50:59 +0800
Subject: [PATCH 99/99] compositor: Fix panel with wrong output error

Caused by:
d611ab24f "libweston: Update view transforms more often".

Signed-off-by: Jeffy Chen <jeffy.chen@rock-chips.com>
---
 libweston/compositor.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/libweston/compositor.c b/libweston/compositor.c
index 4b98574..aa60e53 100644
--- a/libweston/compositor.c
+++ b/libweston/compositor.c
@@ -1260,6 +1260,13 @@ weston_view_assign_output(struct weston_view *ev)
 	uint32_t max, area, mask;
 	pixman_box32_t *e;
 
+	/**
+	 * FIXME: For early assign from:
+	 * d611ab24f "libweston: Update view transforms more often"
+	 */
+	if (!get_view_layer(ev))
+		return;
+
 	/* The static views should bind to the specific output */
 	if (weston_compositor_is_static_layer(get_view_layer(ev))) {
 		struct weston_view *view = ev;
-- 
2.20.1

